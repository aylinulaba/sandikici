---
import BaseLayout from "../layouts/BaseLayout.astro";

const posts = await Astro.glob("../../content/posts/*.md");

posts.sort((a, b) => {
  const da = new Date(a.frontmatter?.date ?? 0).getTime();
  const db = new Date(b.frontmatter?.date ?? 0).getTime();
  return db - da;
});

const toSlug = (file) => file.split("/").pop().replace(".md", "");
---

<BaseLayout>
  <ul class="archive">
    {posts.map((post) => {
      const slug = toSlug(post.file);
      return (
        <li>
          <a href={`/blog/${slug}`}>{post.frontmatter.title}</a>
        </li>
      );
    })}
  </ul>
</BaseLayout>